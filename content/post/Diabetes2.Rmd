---
title: "The Effects of Work and Lifestyle on Individuals with Diabetes"
author: "Group 12"
date: "2020-10-19"
output: pdf_document
---

# Chae Bae, Pritam Sinha, Chen Hao Yu
# October 18, 2020


## Abstract

Out paper is designed to look at the effects of work and lifestyle on the age at which the recipients of the General Social Survey (GSS) are diagnosed with diabetes. Our model will look at a select few variables and attempt to create regression models based on these variables to predict the age at which someone will be diagnosed with diabetes. We have found that individuals who are have longer sleep hours are more likely to be diagnosed with diabetes at an earlier age, and shorter working hours tend to correlate with a earlier diagnoses as well. However, income levels and alcohol consumption on the other hand do not appear to affect the age of diagnosis of diabetes.

## Introduction

According to the World Health Organization, diabetes is currently on the rise, with 422 million people diagnosed with the condition in 2014, up from 108 million in 1980. Adults with diabetes are more likely to be at risk of heart attacks and strokes, and if conditions worsen, could lead to limb amputations and blindness. Diabetes sits as the 9th deadliest illness in the world at a staggering death toll of 1.37 million in 2017, that is more than HIV/AIDS and malaria!

Currently, diabetes is tested and diagnosed through blood sugar tests, and can be treated through regular monitoring of blood sugar, medication, healthy diet, and regular exercise. Therefore, it is imperative that individuals are properly tested for diabetes as soon as possible to avoid worsening conditions.

Lastly, I will be mentioning the R libraries used to clean and model our data. The tidyverse library is an extensive collection of different libraries used commonly in statistical work. In this study, we will be using primarily the dplyr library and the ggplot2 library, both part of the tidyverse collection. The dplyr library is a useful collection that allows us to clean the dataset. We can subset variables using the select function, create new columns using the mutate function, rename column names from their original titles in the GSS survey to more appropriate and descriptive names with the rename function, and group row operations using rowwise. The ggplot2 library allows us to map out our models with a variety of different options, in this study we will be only using a scatterplot using geom_point. Additionally, the Janitor library will be used for the clean_names function, which will help us return names in lowercase form, and substitute spaces with underscores.




## Data

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)


library(janitor)
library(tidyverse)

```


```{r, include=FALSE}

raw_health <- read_csv("AAsD8pYL_1.csv")

```


```{r, include =FALSE}

health <- raw_health %>% select(CASEID, dvperinc, a9cap, h2hrs, k4, m17cap) 


health <- health %>% clean_names() %>% 
    rename (case_id = caseid, age_first_diagnosed_with_diabetes = a9cap,  
            income_12months = dvperinc, 
             sleep_hours = h2hrs, 
            average_drink_for_12_months = k4, 
            work_hours_per_week = m17cap)


health <- health %>% 
  mutate(age_first_diagnosed_with_diabetes = case_when(
      age_first_diagnosed_with_diabetes== 96 ~ as.numeric(NA),
      age_first_diagnosed_with_diabetes== 97 ~ as.numeric(NA),
      age_first_diagnosed_with_diabetes== 98 ~ as.numeric(NA),
      age_first_diagnosed_with_diabetes== 99 ~ as.numeric(NA),
      TRUE ~ as.numeric(age_first_diagnosed_with_diabetes)
))




health <- na.omit(health)

#clean dataset for Linear model, which uses working, sleeping rate and income for variable.


health_linear <- health %>% 
  mutate(work_hours_per_week = case_when(
      work_hours_per_week== 97 ~ as.numeric(NA),
      work_hours_per_week== 99 ~ as.numeric(NA),
      TRUE ~ as.numeric(work_hours_per_week)
))


health_linear <- health_linear %>% 
  mutate(sleep_hours = case_when(
      sleep_hours== 98 ~ as.numeric(NA),
      sleep_hours== 99 ~ as.numeric(NA),
      TRUE ~ as.numeric(sleep_hours)
))


health_linear <- health_linear %>% 
  mutate(income_12months = case_when(
      income_12months== 1 ~ "No income",
      income_12months== 2 ~ "Less than $5,000",
      income_12months== 3 ~ "$5,000 to 9,999",
      income_12months== 4 ~ "$10,000 to 14,999",
      income_12months== 5 ~ "$15,000 to 19,999",
      income_12months== 6 ~ "$20,000 to 29,999",
      income_12months== 7 ~ "$30,000 to 39,999",
      income_12months== 8 ~ "$40,000 to 59,999",
      income_12months== 9 ~ "$60,000 to 79,999",
      income_12months== 10 ~ "$80,000 or more",
      income_12months== 98 ~ as.character(NA),
      income_12months== 99 ~ as.character(NA)
))

health_linear <- health_linear %>% 
  mutate(average_drink_for_12_months = case_when(
      average_drink_for_12_months== 1 ~ "Every day",
      average_drink_for_12_months== 2 ~ "4 - 6 times a week",
      average_drink_for_12_months== 3 ~ "2 - 3 times a week",
      average_drink_for_12_months== 4 ~ "Once a week",
      average_drink_for_12_months== 5 ~ "Once or twice a month",
      average_drink_for_12_months== 6 ~ "Less often than once a month",
      average_drink_for_12_months== 0 ~ as.character(NA),
      average_drink_for_12_months== 8 ~ as.character(NA),
      average_drink_for_12_months== 9 ~ as.character(NA),
))




health_linear <- na.omit(health_linear)
health_linear
```


The data was retrieved from GSS, and after cleaning 66 observations were left.




## Model
```{r}

ggplot(data=health_linear, aes(x=sleep_hours, y=age_first_diagnosed_with_diabetes)) +geom_point() + stat_smooth(method=lm) + ggtitle("Hours spent sleeping each night vs Age first diagnosed with diabetes (Fig.1)") +xlab("Hours spent sleeping each night")+ ylab("Age first diagnosed with diabetes")

ggplot(data=health_linear, aes(x=work_hours_per_week, y=age_first_diagnosed_with_diabetes)) +geom_point() + stat_smooth(method=lm) + ggtitle("Hours spent working per week vs Age first diagnosed with diabetes (Fig.2)") +xlab("Hours spent working per week")+ ylab("Age first diagnosed with diabetes")

ggplot(data = health_linear, aes(x=income_12months, y=age_first_diagnosed_with_diabetes, group = 1)) + geom_point() + stat_smooth(method = lm) + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Personal income during past 12 months vs Age first diagnosed with diabetes(Fig.3)") +xlab("Personal income during past 12 months")+ ylab("Age first diagnosed with diabetes")

ggplot(data = health_linear, aes(x=average_drink_for_12_months, y=age_first_diagnosed_with_diabetes, group = 1)) + geom_point() + stat_smooth(method = lm) + theme(axis.text.x = element_text(angle = 90)) + ggtitle("Frequency of drinking alcoholic beverages in past 12 months vs Age first diagnosed with diabetes (Fig.4)") +xlab("Frequency of drinking alcoholic beverages in past 12 months")+ ylab("Age first diagnosed with diabetes")

lmsleep <- lm(age_first_diagnosed_with_diabetes ~ sleep_hours, data = health_linear)
summary(lmsleep)

lmwork <- lm(age_first_diagnosed_with_diabetes ~ work_hours_per_week, data = health_linear)
summary(lmwork)

lmincome <- lm(age_first_diagnosed_with_diabetes ~ income_12months, data = health_linear)
summary(lmincome)

lmdrink <- lm(age_first_diagnosed_with_diabetes ~ average_drink_for_12_months, data = health_linear)
summary(lmdrink)

lmhealth <- lm(age_first_diagnosed_with_diabetes ~ sleep_hours + work_hours_per_week
               + income_12months + average_drink_for_12_months, data=health_linear)
summary(lmhealth)





```
## Results

Here you will include all results. This includes descriptive statistics, graphs, figures, tables, and model results. Please ensure that everything is well formatted and in a report style. You must also provide an explanation of the results in this section. You can overflow to an Appendix if needed. 

Please ensure that everything is well labelled. So if you have multiple histograms and plots, calling them Figure 1, 2, 3, etc. and referencing them as Figure 1, Figure 2, etc. in your report will be expected. The reader should not get lost in a sea of information. Make sure to have the results be clean, well formatted and digestible.

## Discussion

Here you will discuss conclusions drawn from the results and comment on how it relates to the original goal of the study (which was specified in the Introduction).

# Weaknesses

When looking through the study, data, and analysis there are two clear weaknesses that we believe are quite notable. 

To begin, the first weakness was from the data that we cleaned and filtered.  When looking at our data, we have made slight modifications to all the columns. For example, the “age first diagnosed with diabetes” column has been slightly adjusted to exclude all the values which correspond to labels which do not accurately portray an age. For example. The age values 96 to 99 will not be included since they correspond to those values which are never diagnosed, not applicable, do not know, and not stated; in their respective order. Furthermore, this type of cleaning and filtering has been continued down for other columns including work hours per week, sleep hours, income in the last 12 months, and average number of drinks in the last 12 months. As a result of all of this, our data has been significantly decreased from the original quantity we received from CHASS. 

To continue, the other weakness lies with outliers. Throughout our models, it is clear that there are many outliers within our data. This weakness has a major impact on the linear regression models because the outliers influence the slopes by raising/lowering them. The other models are still influenced as well. If we removed the outliers, our models would be cleaner and much more accurate.

# Next Steps

Here you discuss subsequent work to be done after this report. This can include next steps in terms of statistical analysis (perhaps there is a more efficient algorithm available, or perhaps there is a caveat in the data that would allow for some new technique). Future steps should also be specified in terms of the study setting (eg. including a follow-up survey on something, or a subsequent study that would complement the conclusions of your report).


## References





























